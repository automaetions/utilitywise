<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UtilityWise Energy Analyzer</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --green: #4CD137;
  --green-hover: #2ECC71;
  --red: #E53935;
  --amber: #FFB300;
  --navy1: #0B1F3A;
  --navy2: #123B63;
}

body {
  margin: 0;
  font-family: 'Inter', sans-serif;
  background: linear-gradient(135deg, var(--navy1), var(--navy2));
  color: #111;
}

.container {
  max-width: 1000px;
  margin: auto;
  padding: 20px;
}

.card {
  background: #fff;
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

h1 {
  color: white;
  text-align: center;
}

label {
  font-weight: 600;
  font-size: 14px;
}

input, select {
  width: 100%;
  padding: 8px;
  margin-top: 6px;
  margin-bottom: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

button {
  padding: 8px 12px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

.primary-btn {
  background: linear-gradient(135deg, var(--green), var(--green-hover));
  color: white;
  width: 100%;
  padding: 12px;
  font-weight: 600;
}

.add-btn {
  background: transparent;
  border: 2px solid var(--green);
  color: var(--green);
  width: 100%;
  margin-top: 10px;
}

.remove-btn {
  background: var(--red);
  color: white;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 10px;
  text-align: center;
  border-bottom: 1px solid #eee;
  font-size: 13px;
}

th {
  background: #f5f5f5;
}

.dashboard .metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px,1fr));
  gap: 10px;
  margin-bottom: 15px;
}

.metric {
  background: #f4f7fb;
  padding: 10px;
  border-radius: 10px;
}

.metric strong {
  display: block;
  font-size: 16px;
}

.green { color: var(--green); font-weight: 600; }
.amber { background: #fff3cd; }
.sticky-summary {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: white;
  padding: 10px;
  display: flex;
  justify-content: space-around;
  border-top: 2px solid var(--green);
  font-size: 14px;
}

.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: white;
  padding: 20px;
  border-radius: 16px;
  width: 90%;
  max-width: 400px;
}
</style>
</head>

<body>

<div class="container">

<h1>UtilityWise Energy Analyzer</h1>

<div class="card">
<label>Electricity Rate (₱ per kWh)</label>
<input type="number" id="rate" placeholder="Example: 13">

<label>Search Appliance</label>
<input type="text" id="search" placeholder="Type appliance name...">
<div id="suggestions"></div>

<table id="applianceTable">
<thead>
<tr>
<th>Appliance</th>
<th>Watt</th>
<th>Qty</th>
<th>Hrs</th>
<th>Days</th>
<th>Weeks</th>
<th>Reduce</th>
<th></th>
</tr>
</thead>
<tbody></tbody>
</table>

<button class="add-btn" onclick="addRow()">+ Add Appliance</button>
<button class="primary-btn" onclick="openModal()">View Full Energy Report</button>

</div>

<div id="dashboard" class="card dashboard" style="display:none;"></div>

</div>

<div class="sticky-summary" id="summaryBar">
<span>Monthly: ₱0</span>
<span>Yearly: ₱0</span>
<span class="green">Savings: ₱0</span>
</div>

<div class="modal" id="leadModal">
<div class="modal-content">
<h3>Get Your Full Energy Report</h3>
<input type="text" id="leadName" placeholder="Your Name">
<input type="email" id="leadEmail" placeholder="Your Email">
<input type="text" id="leadPhone" placeholder="Phone (optional)">
<button class="primary-btn" onclick="submitLead()">Get Report</button>
</div>
</div>

<script>

const appliancesDB = [
  {name:"Air Conditioner 1HP", watts:900},
  {name:"Air Conditioner 1.5HP", watts:1200},
  {name:"Refrigerator Small", watts:150},
  {name:"Refrigerator Large", watts:300},
  {name:"Electric Fan", watts:75},
  {name:"LED TV", watts:120},
  {name:"Rice Cooker", watts:1000},
  {name:"Washing Machine", watts:500},
  {name:"Microwave", watts:1100},
  {name:"Electric Kettle", watts:1500}
];

const tbody = document.querySelector("#applianceTable tbody");

function addRow(name="", watts="") {
  const row = document.createElement("tr");
  row.innerHTML = `
    <td><input value="${name}"></td>
    <td><input type="number" value="${watts}"></td>
    <td><input type="number" value="1"></td>
    <td><input type="number" value="1"></td>
    <td><input type="number" value="7"></td>
    <td><input type="number" value="4"></td>
    <td><input type="number" value="0"></td>
    <td><button class="remove-btn" onclick="this.closest('tr').remove(); calculate()">X</button></td>
  `;
  tbody.appendChild(row);
  calculate();
}

addRow();

function calculate() {
  let rate = parseFloat(document.getElementById("rate").value) || 0;
  let rows = tbody.querySelectorAll("tr");

  let totalMonthly=0;
  let totalReduced=0;
  let appliances=[];

  rows.forEach(row=>{
    let inputs=row.querySelectorAll("input");
    let name=inputs[0].value;
    let watts=parseFloat(inputs[1].value)||0;
    let qty=parseFloat(inputs[2].value)||0;
    let hrs=parseFloat(inputs[3].value)||0;
    let days=parseFloat(inputs[4].value)||0;
    let weeks=parseFloat(inputs[5].value)||0;
    let reduce=parseFloat(inputs[6].value)||0;

    let monthlyKwh=(watts/1000)*hrs*days*weeks*qty;
    let monthlyCost=monthlyKwh*rate;
    let newMonthlyKwh=(watts/1000)*Math.max(hrs-reduce,0)*days*weeks*qty;
    let newMonthlyCost=newMonthlyKwh*rate;

    totalMonthly+=monthlyCost;
    totalReduced+=newMonthlyCost;

    appliances.push({name, monthlyCost});
  });

  let yearly=totalMonthly*12;
  let newYearly=totalReduced*12;
  let savings=yearly-newYearly;

  document.getElementById("summaryBar").innerHTML=
    `<span>Monthly: ₱${totalMonthly.toFixed(2)}</span>
     <span>Yearly: ₱${yearly.toFixed(2)}</span>
     <span class="green">Savings: ₱${savings.toFixed(2)}</span>`;
}

tbody.addEventListener("input", calculate);
document.getElementById("rate").addEventListener("input", calculate);

function openModal(){
  document.getElementById("leadModal").style.display="flex";
}

function submitLead(){
  document.getElementById("leadModal").style.display="none";
  document.getElementById("dashboard").style.display="block";
  sendToGHL();
}

function sendToGHL(){
  fetch("YOUR_GHL_WEBHOOK_URL",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({source:"UtilityWise"})
  });
}

</script>
</body>
</html>
